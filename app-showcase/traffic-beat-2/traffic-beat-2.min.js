(function(){function D(t,m){var q,a=0;function e(){if(a+m>+new Date){clearTimeout(q);q=setTimeout(e,m)}else{a=+new Date;t()}}return e}var i=PUBNUB,J=i.$,f=i.attr,x=i.css,E=i.each,r=i.create,y=i.supplant,K=i.publish,L=i.subscribe,M=i.history,u=setInterval,N=setTimeout,F=this.location.href.slice(-400),h=J("traffic-beat-2"),G='<div class="traffic-beat-clear"></div>',O=f(h,"interface")=="on",z=f(h,"channel"),P=+f(h,"interval"),Q=f(h,"demo"),H=+f(h,"url-display-limit")||5,I=[],k={},v={},A=0,w=0;(function(){function t(a){K({channel:z,
message:{page:a,time:+new Date}})}t(F);if(O){x(h,{display:"block"});(function(){var a=r("div");f(a,"class","traffic-beat-ticker-line-box");h.appendChild(a);for(var e=0;e<68;e++){var c=r("div");c.left=e*6;f(c,"class","traffic-beat-ticker-line-off");x(c,{left:c.left});I.push(c);a.appendChild(c)}u(function(){for(var j=0,d;j<68;j++){d=I[j];d.left-=2;if(d.left<-6){d.left=400;if(a.a){a.a=0;f(a,"class","traffic-beat-ticker-line-box")}if(w>0){a.a=1;f(a,"class","traffic-beat-ticker-line-box-highlight");w--;
f(d,"class","traffic-beat-ticker-line-on");d.b=1}else if(d.b){f(d,"class","traffic-beat-ticker-line-off");d.b=0}}x(d,{left:d.left})}},P)})();(function(){u(function(){},1E4)})();var m;(function(){function a(b,g,n){b.innerHTML=[B.replace(d,">"+g+"<"),C.replace(d,">"+n+"<"),Array(1+Math.ceil(g)).join(o)||o,G].join("")}var e=r("div"),c=r("div"),j=r("div"),d=/></,B='<div class="traffic-beat-bar-text-rpm"></div>',C='<div class="traffic-beat-bar-text"></div>',o='<div class="traffic-beat-bar"><div class="traffic-beat-bar-shine"></div></div>';
f(e,"class","traffic-beat-bar-box");f(c,"class","traffic-beat-bar-box");f(j,"class","traffic-beat-bar-box");h.appendChild(e);h.appendChild(c);h.appendChild(j);m=D(function(){var b=0,g=0,n=0,s=+new Date;for(var l in v){var p=(s-l)/1E3;if(3610<p)delete v[l];else{61>p&&b++;601>p&&g++;3601>p&&n++}}g/=10;n/=60;a(e,b,"RPM Instant");a(c,g,"10 Minute Average");a(j,n,"60 Minute Average")},500);u(m,2E3)})();Q&&u(function(){N(function(){t(F+"#"+Math.ceil(Math.random()*H))},Math.ceil(Math.random()*6E3+600))},
1E3);var q;(function(){function a(o,b,g){b=Math.ceil(b*100);b=b>90?90:b;b=b<6?6:b;c.push('<div class="traffic-beat-percent-bar" ',"onmouseup=\"location.href='",o,"'\">",d,y(B,{text:"/"+o.split("/").slice(3).join("/").substr(0,60)}),y(C,{percent:b,count:g}),y(j,{percent:b}),G,"</div>")}var e=r("div"),c=[],j='<div class="traffic-beat-percent-bar-meter" style="width:{percent}%"></div>',d='<div class="traffic-beat-percent-bar-shine"></div>',B='<div class="traffic-beat-percent-bar-text-url">{text}</div>',
C='<div class="traffic-beat-percent-bar-text-percent">{count} ({percent}%)</div>';h.appendChild(e);q=D(function(){var o=0,b=[];c=[];c.push('<div class="traffic-beat-sep"></div>');E(k,function(s,l){b.push({page:s,count:l.count,time:l.time})});b.sort(function(s,l){var p=l.time-s.time;if(!p)return l.c-s.c;return p});for(var g=0,n=b.length;g<n;g++)o++>H||a(b[g].page,b[g].count/A,b[g].count);e.innerHTML=c.join("")},1E3)})();L({channel:z},function(a){w++;A++;k[a.page]||(k[a.page]={url:a.page,count:0});
k[a.page].count++;k[a.page].time=+new Date;v[+new Date]=1;q();m()});M({channel:z,limit:100},function(a){var e=+new Date;w++;E(a,function(c){A++;k[c.page]||(k[c.page]={url:c.page,time:c.time||e,count:0});k[c.page].count++;v[+new Date]=1;q();m()})})}})()})();
